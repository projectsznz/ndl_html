<!DOCTYPE html>
<html lang="en">

<head>
    <title>Unwaste Network </title>
    <!-- HTML5 Shim and Respond.js IE10 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 10]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
      <![endif]-->
    <!-- Meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="#">
    <meta name="keywords"
        content="Admin , Responsive, Landing, Bootstrap, App, Template, Mobile, iOS, Android, apple, creative app">
    <meta name="author" content="#">
    <!-- Favicon icon -->
    <link rel="icon" href="..\..\files\assets\images\favicon.ico" type="image/x-icon">
    <!-- Google font-->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,800" rel="stylesheet">
    <!-- Required Fremwork -->
    <link rel="stylesheet" type="text/css" href="..\..\files\bower_components\bootstrap\css\bootstrap.min.css">
    <!-- themify-icons line icon -->
    <link rel="stylesheet" type="text/css" href="..\..\files\assets\icon\themify-icons\themify-icons.css">
    <!-- ico font -->
    <link rel="stylesheet" type="text/css" href="..\..\files\assets\icon\icofont\css\icofont.css">
    <!-- feather Awesome -->
    <link rel="stylesheet" type="text/css" href="..\..\files\assets\icon\feather\css\feather.css">
    <!--foo table Grid-->
    <link rel="stylesheet" type="text/css" href="..\..\files\assets\pages\foo-table\css\footable.bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="..\..\files\assets\pages\foo-table\css\footable.standalone.min.css">
    <!-- Style.css -->
    <link rel="stylesheet" type="text/css" href="..\..\files\assets\css\style.css">
    <link rel="stylesheet" type="text/css" href="../Css/Index.css">
    <link rel="stylesheet" type="text/css" href="..\..\files\assets\css\jquery.mCustomScrollbar.css">

</head>

<body>
    <!-- Pre-loader start -->
    <div class="theme-loader">
        <div class="ball-scale">
            <div class='contain'>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
            </div>
        </div>
    </div>
    <!-- Pre-loader end -->
    <div id="pcoded" class="pcoded">
        <div class="pcoded-overlay-box"></div>
        <div class="pcoded-container navbar-wrapper">
            <nav class="navbar header-navbar pcoded-header">
                <div class="navbar-wrapper">

                    <div class="navbar-logo">
                        <a class="mobile-menu" id="mobile-collapse" href="#!">
                            <i class="feather icon-menu"></i>
                        </a>
                        <a href="../Dashboard/dashboard_Index.htm">
                            <img class="img-fluid" src="../../files/assets/images/Logo-1.jpeg" alt="Theme-Logo">
                        </a>
                        <a class="mobile-options">
                            <i class="feather icon-more-horizontal"></i>
                        </a>
                    </div>

                    <div class="navbar-container container-fluid">
                        <ul class="nav-left">
                            <li class="header-search">
                                <div class="main-search morphsearch-search">
                                    <div class="input-group">
                                        <span class="input-group-addon search-close"><i
                                                class="feather icon-x"></i></span>
                                        <input type="text" class="form-control">
                                        <span class="input-group-addon search-btn"><i
                                                class="feather icon-search"></i></span>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <a href="#!" onclick="javascript:toggleFullScreen()">
                                    <i class="feather icon-maximize full-screen"></i>
                                </a>
                            </li>
                        </ul>
                        <ul class="nav-right">
                            <li class="user-profile header-notification">
                                <div class="dropdown-primary dropdown">
                                    <div class="dropdown-toggle" data-toggle="dropdown">
                                        <img src="..\..\files\assets\images\avatar-4.jpg" class="img-radius"
                                            alt="User-Profile-Image">
                                        <span id="user">John Doe</span>
                                        <i class="feather icon-chevron-down"></i>
                                    </div>
                                    <ul class="show-notification profile-notification dropdown-menu"
                                        data-dropdown-in="fadeIn" data-dropdown-out="fadeOut">
                                        
                                        <li>
                                            <a href="../auth-normal-sign-in.htm">
                                                <i class="feather icon-log-out"></i> Logout
                                            </a>
                                        </li>
                                    </ul>

                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>

            <div class="pcoded-main-container">
                <div class="pcoded-wrapper">
                    <nav class="pcoded-navbar">
                        <div class="pcoded-inner-navbar main-menu">
                    
                            <ul class="pcoded-item pcoded-left-item">
                                <li class=" ">
                                    <a href="../Dashboard/dashboard_Index.htm">
                                        <span class="pcoded-micon"><i class="feather icon-home"></i></span>
                                        <span class="pcoded-mtext">Dashboard</span>
                                    </a>
                                 
                                </li>
                                <li class="pcoded-hasmenu ">
                                    <a href="javascript:void(0)">
                                        <span class="pcoded-micon"><i class="fa fa-user" aria-hidden="true"></i></span>
                                        <span class="pcoded-mtext">Admin User</span>
                                    </a>
                                    <ul class="pcoded-submenu">
                                        <li class="">
                                            <a href="../Admin-user/Add-admin.htm">
                                                <span class="pcoded-mtext">New Admin</span>
                                            </a>
                                        </li>
                                        <li class="">
                                            <a href="../Admin-user/Admin-List.htm">
                                                <span class="pcoded-mtext">Admin List</span>
                                            </a>
                                        </li>
                    
                                    </ul>
                                </li>
                                <li class="pcoded-hasmenu ">
                                    <a href="javascript:void(0)">
                                        <span class="pcoded-micon"><i class="fa fa-user-times"></i></span>
                                        <span class="pcoded-mtext">Driver Management</span>
                                    </a>
                                    <ul class="pcoded-submenu">
                                        <li class="">
                                            <a href="../Driver-management/Add-Driver.htm">
                                                <span class="pcoded-mtext">New Driver</span>
                                            </a>
                                        </li>
                                        <li class="">
                                            <a href="../Driver-management/Driver-List.htm">
                                                <span class="pcoded-mtext">Driver List</span>
                                            </a>
                                        </li>
                    
                                    </ul>
                                </li>
                                <li class="pcoded-hasmenu">
                                    <a href="javascript:void(0)">
                                        <span class="pcoded-micon"><i class="fa fa-car"></i></span>
                                        <span class="pcoded-mtext">Vehicle Management</span>
                                   
                                    </a>
                                    <ul class="pcoded-submenu">
                                        <li class="">
                                            <a href="../Vehicle-management/Add-Vehicle.htm">
                                                <span class="pcoded-mtext">New Vehicle</span>
                                            </a>
                                        </li>
                                        <li class="">
                                            <a href="../Vehicle-management/Vehicle-List.htm">
                                                <span class="pcoded-mtext">Vehicle List</span>
                                            </a>
                                        </li>
                    
                                    </ul>
                                </li>
                                <li class="pcoded-hasmenu">
                                    <a href="javascript:void(0)">
                                        <span class="pcoded-micon"><i class="fa fa-building"></i></span>
                                        <span class="pcoded-mtext">Apartment Management </span>
                                    </a>
                                    <ul class="pcoded-submenu">
                                        <li class="">
                                            <a href="../Apartment-management/Add-Apartment.htm">
                                                <span class="pcoded-mtext">New Apartment</span>
                                            </a>
                                        </li>
                                        <li class="">
                                            <a href="../Apartment-management/Apartment-List.htm">
                                                <span class="pcoded-mtext">Apartment List</span>
                                            </a>
                                        </li>
                    
                                    </ul>
                    
                                </li>
                                <li class="pcoded-hasmenu">
                                    <a href="javascript:void(0)">
                                        <span class="pcoded-micon"><i class="feather icon-layers"></i></span>
                                        <span class="pcoded-mtext">Waste Management</span>
                        
                                    </a>
                                    <ul class="pcoded-submenu">
                                        <li class="">
                                            <a href="../Wastage-management/wastage-count.htm">
                                                <span class="pcoded-mtext">Wastage Count</span>
                                            </a>
                                        </li>
                                        <li class="">
                                            <a href="../Wastage-management/wastage-weighs.htm">
                                                <span class="pcoded-mtext">Wastage Weighs</span>
                                            </a>
                                        </li>
                                        <li class="">
                                            <a href="../Wastage-management/unload-point.htm">
                                                <span class="pcoded-mtext">Unload point master</span>
                                            </a>
                                        </li>
                    
                                    </ul>
                                </li>
                                <li class="pcoded-hasmenu">
                                    <a href="javascript:void(0)">
                                        <span class="pcoded-micon"><i class="fa fa-map-marker"></i></span>
                                        <span class="pcoded-mtext">Route Management </span>
                                    </a>
                                    <ul class="pcoded-submenu">
                                        <li class="">
                                            <a href="../Route-management/Route-master.html">
                                                <span class="pcoded-mtext">Route master</span>
                                            </a>
                                        </li>
                                        <li class="">
                                            <a href="../Route-management/Route-assigning.html">
                                                <span class="pcoded-mtext">Route assigning</span>
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                                <li class=" ">
                                    <a href="../Reports/Reports.htm">
                                        <span class="pcoded-micon"><i class="fa fa-signal"></i></span>
                                        <span class="pcoded-mtext">Report</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </nav>
                    <div class="pcoded-content">
                        <div class="pcoded-inner-content">
                            <!-- Main-body start -->
                            <div class="main-body">
                                <div class="page-wrapper pd-t">
                                    <!-- Page-header start -->
                                    <div class="page-header ">
                                        <div class="row ">
                                            <div class="col-lg-12">
                                                <div class="page-header-breadcrumb">
                                                    <ul class="breadcrumb-title">
                                                        <li class="breadcrumb-item">
                                                            <a href="../Dashboard/dashboard_Index.htm"> <i class="feather icon-home"></i>
                                                            </a>
                                                        </li>
                                                        <li class="breadcrumb-item"><a href="#!">Driver Management / Driver List</a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Page-header end -->

                                    <!-- Page-body start -->
                                    <div class="page-body">
                                        <!-- Filtering Foo-table card start -->
                                        <div class="card">
                                            <div class="card-block table-scroll">
                                                <table id="demo-foo-filtering" class="table table-striped">
                                                    <thead>
                                                        <tr>
                                                            <th>S.No</th>
                                                            <th>Name</th>
                                                            <th data-breakpoints="xs">Phone</th>
                                                            <th data-breakpoints="xs">Email</th>
                                                            <th data-breakpoints="xs">Driver license No</th>
                                                            <th>Status</th>
                                                            <th>Action</th>
                                                        </tr>

                                                    </thead>
                                                    
                                                </table>
                                            </div>
                                        </div>
                                        <!-- Filtering Foo-table card end -->

                                    </div>
                                    <!-- Page-body end -->
                                </div>
                            </div>

                            <!-- Modal -->
                            <div class="modal fade" id="Edit" role="dialog">
                                <div class="modal-dialog modal-update">

                                    <!-- Modal content-->
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h4 class="modal-title">Update Driver </h4>
                                        </div>
                                        <div class="modal-body">
                                            <form id="update-driver-form">
                                                <div class="row">
                                                    <div class="col-lg-6 col-md-6 col-sm-12 mg-btm">
                                                        <label class=" col-form-label">Name</label>
                                                        <input type="text" id="name" class="form-control">
                                                    </div>
                                                    <div class="col-lg-6 col-md-6 col-sm-12 mg-btm">
                                                        <label class=" col-form-label">Phone</label>
                                                        <input type="text" id="phone" class="form-control">
                                                    </div>
                                                    <div class="col-lg-6 col-md-6 col-sm-12 mg-btm">
                                                        <label class=" col-form-label">Email</label>
                                                        <input type="email" id="email" class="form-control">
                                                    </div>
                                                    <div class="col-lg-6 col-md-6 col-sm-12 mg-btm">
                                                        <label class=" col-form-label">Driver license No</label>
                                                        <input type="text" id="license_no" class="form-control">
                                                    </div>
                                                    <div class="col-lg-6 col-md-6 col-sm-12 mg-btm">
                                                        <label class=" col-form-label" >Status</label>
                                                        <select class="form-control" name="status" id="status">
                                                            <option value="0">Active</option>
                                                            <option value="1">Disabled</option>
                                                        </select>
                                                    </div>
                                                    <div class="col-lg-6 col-md-6 col-sm-12 mg-btm">
                                                        <label class=" col-form-label">Driver license copy</label>
                                                        <input type="file" id="license_copy" name="license_copy" class="form-control">
                                                    </div>
                                                    <div class="col-lg-6 col-md-6 col-sm-12 mg-btm">
                                                        <label class=" col-form-label">Driver photo</label>
                                                        <input type="file" id="photo" name="photo" class="form-control">
                                                    </div>

                                                </div>
                                            </form>
                                        </div>
                                        <div class="modal-footer submit-btn">
                                            <button type="button" class="btn btn-primary btn-outline-primary"
                                                data-dismiss="modal">Cancel</button>
                                            <button type="button"
                                                class="btn btn-primary waves-effect waves-light add updateDriverUser btn-square"
                                                data-dismiss="modal">Update</button>
                                        </div>
                                    </div>

                                </div>
                            </div>

                            <div class="modal fade" id="Delet" role="dialog">
                                <div class="modal-dialog">

                                    <!-- Modal content-->
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h4 class="modal-title">Delete </h4>
                                        </div>
                                        <div class="modal-body">
                                            <p class="alg-ct">Do you want Delete this one ?</p>
                                        </div>
                                        <div class="modal-footer submit-btn">

                                            <button type="button"
                                                class="btn btn-primary waves-effect waves-light add deleteDriverUser btn-square"
                                                data-dismiss="modal">Confirm</button>
                                            <button type="button" class="btn btn-primary btn-outline-primary"
                                                data-dismiss="modal">Cancel</button>
                                        </div>
                                    </div>

                                </div>
                                <!-- Main-body end -->

                                <div id="styleSelector">

                                </div>
                            </div>
                            <div id="Result-Message" class="modal fade bd-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
                                <div class="modal-dialog modal-sm">
                              
                                  <div class="modal-content"> 
                                    <!-- Div you want to update the content -->
                                    <div class="modal-body modal-content-message">
                                        
                                    </div>
                                  </div>
                                  <div class="modal-footer-message submit-btn">
                                    <button type="button"
                                        onclick="closeMessage()"
                                        class="btn btn-primary waves-effect waves-light closeMessage btn-square"
                                        data-dismiss="modal">Confirm</button>
                                  </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Warning Section Ends -->
        
        <!-- api -->
        <script type="text/javascript" src="..\..\files\assets\js\api-conditions.js"></script>
        <!-- Required Jquery -->
        <script type="text/javascript" src="..\..\files\bower_components\jquery\js\jquery.min.js"></script>
        <script type="text/javascript" src="..\..\files\bower_components\jquery-ui\js\jquery-ui.min.js"></script>
        <script type="text/javascript" src="..\..\files\bower_components\popper.js\js\popper.min.js"></script>
        <script type="text/javascript" src="..\..\files\bower_components\bootstrap\js\bootstrap.min.js"></script>
        <script type="text/javascript" src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
        <!-- jquery slimscroll js -->
        <script type="text/javascript"
            src="..\..\files\bower_components\jquery-slimscroll\js\jquery.slimscroll.js"></script>
        <!-- modernizr js -->
        <script type="text/javascript" src="..\..\files\bower_components\modernizr\js\modernizr.js"></script>
        <script type="text/javascript" src="..\..\files\bower_components\modernizr\js\css-scrollbars.js"></script>

        <!--FOO Table js-->
        <script src="..\..\files\assets\pages\foo-table\js\foo-table-custom.js"></script>
        <!-- i18next.min.js -->
        <script type="text/javascript" src="..\..\files\bower_components\i18next\js\i18next.min.js"></script>
        <script type="text/javascript"
            src="..\..\files\bower_components\i18next-xhr-backend\js\i18nextXHRBackend.min.js"></script>
        <script type="text/javascript"
            src="..\..\files\bower_components\i18next-browser-languagedetector\js\i18nextBrowserLanguageDetector.min.js"></script>
        <script type="text/javascript" src="..\..\files\bower_components\jquery-i18next\js\jquery-i18next.min.js"></script>
        <!-- Custom js -->
        <script src="../js/icon.js"></script>
        <script src="..\..\files\assets\js\pcoded.min.js"></script>
        <script src="..\..\files\assets\js\vartical-layout.min.js"></script>
        <script src="..\..\files\assets\js\jquery.mCustomScrollbar.concat.min.js"></script>
        <script type="text/javascript" src="..\..\files\assets\js\script.js"></script>
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-23581568-13"></script>
        <script>
            $(function() {
                $('#sidebar').load('../sidebar/sidebar.html')
            })
        </script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            gtag('js', new Date());

            gtag('config', 'UA-23581568-13');
        </script>

        <script>
            // Get the modal
            var modal = document.getElementById("myModal");

            // Get the button that opens the modal
            var btn = document.getElementById("myBtn");

            // Get the <span> element that closes the modal
            var span = document.getElementsByClassName("close")[0];

            // When the user clicks the button, open the modal 

            var myHeaders = new Headers();
            let token = loginCheck().data.token
            myHeaders.append("Authorization", `Bearer ${token}`);

            var requestOptions = {
                method: 'POST',
                headers: myHeaders,
                redirect: 'follow'
            };

            fetch("http://assistlysolutions.com/ndl/api/route-mapping/list", requestOptions)
                .then(response => response.json())
                .then(result => {
                    let sno = 0;
                    // console.log('data '+result.data.data)
                    let contentTable = document.querySelector('table');
                    console.log('contentTable', contentTable)
                    let contentTbody = document.createElement('tbody')
                    contentTable.appendChild(contentTbody);
                    //contentTbody.innerHTML = ''
                    
                    result.data.map((data) => {
                        sno = sno+1;
                        // if length of data not equal to zero must be delete the dome class="footable-empty"
                        
                        console.log('data', data)
        //                 if(data.license_no == ''){
        //                     data.license_no = 'null';
        //                 }
        //                 if(data.license_copy == ''){
        //                     data.license_copy = 'null';
        //                 }
        //                 let rowsList = `
        // <tr class="footable-empty">
        //     <td>${sno}</td>
        //     <td>${data.name}</td>
        //     <td>${data.phone}</td>
        //     <td>${data.email}</td>
        //     <td>${data.license_no}</td>  
        //     <td>${data.status}</td>
        //     <td>
        //         <button
        //         data-id=${data.id}
        //          data-name=${data.name}
        //          data-phone=${data.phone}
        //          data-license_no=${data.license_no}
        //          data-email=${data.email}
        //          data-status=${data.status}
        //          data-photo=${data.photo}
        //          data-license_copy=${data.license_copy}
        //          onclick="updateDriverUser(this.getAttribute('data-id'),this.getAttribute('data-name'),this.getAttribute('data-phone'), this.getAttribute('data-license_no'), this.getAttribute('data-email'), this.getAttribute('data-status'), this.getAttribute('data-photo'), this.getAttribute('data-license_copy'))"
        //          type="button" class="tab-edit-btn" data-toggle="modal" data-target="#Edit"><i class='far fa-edit'></i></button>
               
        //     </td>
        // </tr> `
        //                 // tableRow.innerHTML = rowsList;
        //                 contentTbody.innerHTML += rowsList
                    })
                    if(result.data.data.length >0){
                        $(document).ready( function () {
                            $('.table').DataTable({
                                "dom": 'rtip',
                                "searching": false,
                                "paging": true,
                                "scrollX": true,
                                "columnDefs": [
                                    { "orderable": false, "targets": [ -1 ] }
                                ],
                                "iDisplayLength": 10
                            });
                        } );
                    }
                })
                .catch(error => console.log('error', error));

                //Edit Data on form submit

    var preUpdateMaster={}
function updateDriverUser(id, name, phone, license_no, email, status, photo, license_copy) {
    // console.log(e)
    console.log('Phone' + license_copy);
    document.getElementById("name").value = name;
    document.getElementById("phone").value = phone;
    document.getElementById("license_no").value = license_no;
    document.getElementById("email").value = email;
    document.getElementById("status").value = status;
    preUpdateMaster = {id, name, phone, email, status,license_copy, photo}
}

const update = document.querySelector('.updateDriverUser');
update.addEventListener('click', (e) => {
    e.preventDefault()
    let name = document.getElementById('name').value;
    let phone = document.getElementById("phone").value;
    let license_no = document.getElementById("license_no").value;
    let email = document.getElementById("email").value;
    let status = document.getElementById("status").value;
    let photo = document.getElementsByName("photo");
    let license_copy = document.getElementsByName("license_copy");

    console.log('license_copy' + license_copy);

    console.log('photo ' + photo[0].files[0]);
    var formdata = new FormData();
    formdata.append("type", "2");
    formdata.append("name", name);
    formdata.append("phone", phone);
    formdata.append("license_no", license_no)
            formdata.append("email", email);
            formdata.append("photo", photo[0].files[0], photo[0].value);
            formdata.append("license_copy", license_copy[0].files[0], license_copy[0].value);
            formdata.append("status", status);
            formdata.append("id",preUpdateMaster.id);
    var updateRequestOptions = {
        method: 'POST',
        headers: myHeaders,
        body: formdata,
        redirect: 'follow'
    };
    fetch("http://assistlysolutions.com/ndl/api/users/edit", updateRequestOptions)
  .then(response => response.json())
  .then(result => {
    
    
    $('#Result-Message').modal('toggle')
    let contentMessage = document.querySelector('.modal-content-message');
    let contentstatus = document.createElement('div')
    contentstatus.innerHTML = "<p>"+ result.message + "</p>"
    contentMessage.appendChild(contentstatus)
    })
  .then(err => {
    $('.modal-content-message').text(err)
    $('#Result-Message').modal('toggle')
    }).finally(() => document.getElementById('update-driver-form').reset())
})

//Delete Data on form
function deleteDriverUser(id) {
    console.log(id);
    var formdata = new FormData();
    formdata.append("id",id);

    fetch("http://assistlysolutions.com/ndl/api/users/delete" , {
        method: 'POST',
        headers: myHeaders,
        body: formdata
    }).then(res => res.text())
    .then(res => console.log(res))
}

function closeMessage() {
    $('#Result-Message').modal('toggle');
    document.location.reload(true);
}
        </script>
</body>

</html>